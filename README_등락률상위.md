# 📊 등락률 상위 자동화

구글 시트 **시트2**에 재료별 종목 데이터를 입력하면 자동으로 깔끔한 테이블 이미지를 생성합니다.

## ✨ 주요 특징

- ✅ **재료별 색상 구분**: 같은 재료가 2개 이상이면 고유 색상, 1개면 회색
- ✅ **자동 정렬**: 2개 이상 재료 먼저, 1개 재료 나중에 + 등락률 순서
- ✅ **페이지 자동 분할**: 20개 종목 초과 시 자동으로 여러 페이지 생성
- ✅ **깔끔한 테이블 디자인**: 재료에만 색상, 나머지는 흰색 배경
- ✅ **날짜 불필요**: 시트2의 모든 데이터를 가져와서 처리

## 📝 구글 시트 입력 형식 (시트2)

| A열(날짜) | B열(재료) | C열(종목명) | D열(등락률) | E열(거래대금) | F열(내용) |
|-----------|-----------|-------------|-------------|---------------|-----------|
| (비워도됨) | 건설 | 한신공영 | 30.00 | 38679 | 정부 공급 확대... |
| | 건설 | 동신건설 | 29.31 | 12704 | 건설산업 정상화... |
| | 로봇 | 링크솔루션 | 29.92 | 77999 | 보스턴다이내믹스... |

**핵심 규칙:**
- **재료(B열)**: 같은 재료끼리 그룹화됨 (정확히 동일하게 입력!)
- **등락률(D열)**: 숫자만 입력 (자동 포맷팅)
- **거래대금(E열)**: 백만원 단위 숫자
- **날짜(A열)**: 사용하지 않음 (비워도 OK)

## 🚀 빠른 시작

### 방법 1: GitHub Actions로 실행 (추천! 🌟)

**설치 없이 GitHub에서 바로 실행 가능!**

1. 구글 시트 시트2에 데이터 입력
2. GitHub Actions 탭 → **"등락률 상위 자동 생성"** 선택
3. `Run workflow` 클릭
4. 생성된 이미지 다운로드

👉 **[GitHub 사용법 보기 (필독!)](GitHub_사용법.md)**

---

### 방법 2: 로컬 설치

#### 1. 설치 (한 번만)

```bash
# 필요한 라이브러리 설치
pip install -r requirements.txt

# Playwright 브라우저 설치
python -m playwright install chromium
```

#### 2. 실행

**Windows:**
```bash
# 배치 파일 더블클릭
실행_등락률상위.bat

# 또는 명령어
python main_ranking.py
```

**Mac/Linux:**
```bash
python main_ranking.py
```

#### 3. 결과 확인

`output` 폴더에 이미지 생성:
```
output/
├── 등락률상위_20251203.png
└── 등락률상위_20251203_2.png  (20개 초과 시)
```

## 🎨 색상 규칙

### 2개 이상 재료 → 고유 색상
- 건설 (3개) → 🟡 노란색
- 고속터미널 (3개) → 🟢 초록색
- 로봇 (3개) → 🔵 하늘색
- 바이오 (5개) → 🟣 보라색

### 1개 재료 → 회색
- 데이터센터 (1개) → ⚪ 회색
- 의료로봇 (1개) → ⚪ 회색

## 📊 출력 순서

1. **2개 이상 재료** (등락률 높은 순)
   - 각 재료 내에서도 등락률 순서 정렬
   
2. **1개 재료** (등락률 높은 순)
   - 회색으로 표시

3. **20개 초과 시** 자동으로 페이지 분할

## 🔧 문제 해결

### "시트2를 찾을 수 없습니다"
- 구글 시트에 "시트2" 탭이 있는지 확인
- 탭 이름이 정확한지 확인

### "데이터가 없습니다"
- B~F열에 데이터가 있는지 확인
- 재료(B열)와 종목명(C열)이 비어있지 않은지 확인

### "구글 시트 연결 실패"
- `service_account.json.json` 파일 확인
- 구글 시트 공유 설정 확인

## 💡 사용 팁

1. **재료명 통일**: "건설"과 "건설 " (공백)은 다른 재료로 인식
2. **자동 정렬**: 시트에서 순서 신경 안 써도 자동 정렬됨
3. **색상 자동**: 재료 개수에 따라 자동으로 색상 결정
4. **내용 길이**: 너무 길면 자동 줄바꿈

## 📁 파일 구조

```
issue-automation/
├── main_ranking.py              # 메인 실행 파일
├── sheet_reader_ranking.py      # 시트2 데이터 읽기
├── html_renderer_ranking.py     # HTML → 이미지 변환
├── template_ranking.html        # 테이블 디자인
├── 실행_등락률상위.bat          # Windows 실행 스크립트
├── 등락률상위_사용법.md         # 상세 사용 설명서
└── output/                      # 생성된 이미지 저장
```

## 🤝 기존 시스템과의 관계

- **급등이슈 카드** (`main.py`) - 시트1 사용
- **등락률 상위 테이블** (`main_ranking.py`) - 시트2 사용

두 시스템은 완전히 독립적으로 작동합니다!

## 📞 문의

문제가 있으면 이슈를 등록해주세요!

