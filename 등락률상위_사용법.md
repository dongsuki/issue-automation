# 📊 등락률 상위 자동화 사용법

구글 시트 **시트2**에 데이터를 입력하면 자동으로 등락률 상위 테이블 이미지를 생성합니다.

## 🎯 주요 특징

- ✅ **재료별 자동 그룹화**: 같은 재료끼리 묶어서 표시
- ✅ **색상 구분**: 같은 재료가 2개 이상이면 고유 색상, 1개면 회색
- ✅ **등락률 순서 정렬**: 각 재료 내에서 등락률 높은 순서대로 표시
- ✅ **테이블 형식**: 깔끔한 표 형식으로 한눈에 보기 쉽게

## 📝 구글 시트 입력 형식 (시트2)

| A열(날짜) | B열(재료) | C열(종목명) | D열(등락률) | E열(거래대금) | F열(내용) |
|-----------|-----------|-------------|-------------|---------------|-----------|
| 12.03 | 건설 | 한신공영 | 30.00 | 38679 | 정부 공급 확대... |
| 12.03 | 건설 | 동신건설 | 29.31 | 12704 | 건설산업 정상화... |
| 12.03 | 로봇 | 링크솔루션 | 29.92 | 77999 | 보스턴다이내믹스... |
| 12.03 | 바이오 | 삼성에피스홀딩스 | 24.21 | 1914128 | 에피스의 신약... |

**입력 규칙:**
- **날짜(A열)**: 사용하지 않음 (비워도 됨)
- **재료(B열)**: 반드시 입력 (같은 재료끼리 그룹화됨)
- **등락률(D열)**: 숫자만 입력 (%, 콤마 자동 처리)
- **거래대금(E열)**: 백만원 단위 숫자 (콤마 자동 추가)
- **1페이지 최대 20개 종목**: 초과 시 자동으로 여러 페이지 생성

## 🚀 실행 방법

### 방법 1: 배치 파일로 실행 (가장 쉬움)

1. `실행_등락률상위.bat` 파일 더블클릭
2. 자동으로 시트2의 모든 데이터를 가져와서 이미지 생성
3. `output` 폴더에 이미지 저장

### 방법 2: 명령어로 실행

```bash
# 시트2의 모든 데이터 사용
python main_ranking.py
```

## 📁 결과물

생성된 이미지는 `output` 폴더에 저장됩니다:

```
output/
└── 등락률상위_20251203.png
```

## 🎨 색상 규칙

- **같은 재료가 2개 이상**: 자동으로 고유 색상 할당
  - 예) 건설(노란색), 로봇(초록색), 바이오(하늘색)...
  
- **같은 재료가 1개만**: 회색으로 표시
  - 예) 데이터센터 종목이 1개만 있는 경우

## 🔧 문제 해결

### "시트2를 찾을 수 없습니다"
- 구글 시트에 시트2가 있는지 확인
- 시트 이름이 정확한지 확인

### "데이터가 없습니다"
- A열(날짜)에 오늘 날짜가 입력되어 있는지 확인
- B~F열이 비어있지 않은지 확인

### "구글 시트 연결 실패"
- `service_account.json.json` 파일이 있는지 확인
- 구글 시트 공유 설정 확인 (서비스 계정 이메일과 공유)

## 📌 팁

1. **등락률 순서**: 자동으로 높은 순서대로 정렬되므로 시트에서 순서 신경 안 써도 됨
2. **재료명 통일**: 재료명은 정확히 똑같이 입력해야 같은 그룹으로 인식
3. **내용 길이**: 내용이 너무 길면 자동 줄바꿈됨
4. **거래대금**: 천 단위 콤마 자동 추가되므로 숫자만 입력
5. **출력 순서**: 2개 이상 재료(색상) → 1개 재료(회색) 순서로 자동 정렬
6. **페이지 분할**: 20개 초과 시 자동으로 여러 페이지 생성

## 🎯 예시

### 입력 (시트2)
```
날짜  | 재료 | 종목명    | 등락률 | 거래대금 | 내용
12.03 | 건설 | 한신공영  | 30.00  | 38679   | 정부 공급 확대...
      | 건설 | 동신건설  | 29.31  | 12704   | 건설산업 정상화...
      | 로봇 | 링크솔루션| 29.92  | 77999   | 보스턴다이내믹스...
```

### 출력
- 건설 그룹: 한신공영(30.00%), 동신건설(29.31%) - 노란색 배경
- 로봇 그룹: 링크솔루션(29.92%) - 회색 배경 (1개만 있음)

## 📞 문의

문제가 있으면 이슈를 등록해주세요!

