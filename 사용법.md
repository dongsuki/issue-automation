# 오늘의 급등이슈 자동화

구글 시트에 데이터를 입력하면 자동으로 예쁜 이미지를 생성합니다.

## 📝 사용 방법

### 1단계: 구글 시트에 데이터 입력
- 시트 주소: https://docs.google.com/spreadsheets/d/1dX8Diej7AQixm7fBrnrdUybxW2Au9QzyATYRBKZN_jk/

| A열(날짜) | B열(타입) | C열(그룹명) | D열(종목명) | E열(등락률) | F열(이슈내용) |
|-----------|-----------|-------------|-------------|-------------|---------------|
| 12.04 | 테마 | 반도체 | 삼성전자 | 3.50% | 반도체 훈풍에 상승 |
| 12.04 | 테마 | 반도체 | SK하이닉스 | 3.50% | |
| 12.04 | 개별 | 개별이슈 | 코칩 | 29.98% | 美 엔비디아에 공급 |

**중요:**
- 테마: 같은 그룹명으로 5개 이하씩 묶임 (5개 초과 시 자동 분리)
- 개별: 3개씩 자동 분리
- 이슈내용(F열): 테마는 첫 번째 행에만 입력, 개별은 모든 행에 입력

### 2단계: 프로그램 실행

**방법 1) 더블클릭 (가장 간단)**
```
실행.bat 파일을 더블클릭
```

**방법 2) 명령 프롬프트**
```bash
cd "C:\Users\USER\Desktop\issue automation"
python main.py
```

### 3단계: 생성된 이미지 확인
- 위치: `output` 폴더
- 파일명: `급등이슈_251204_1.png`, `급등이슈_251204_2.png` ...

## 📁 프로젝트 구조

```
issue automation/
├── 실행.bat              ← 더블클릭으로 실행
├── main.py               ← 메인 프로그램
├── sheet_reader.py       ← 구글 시트 연동
├── html_renderer.py      ← 이미지 생성
├── template.html         ← 디자인 템플릿
├── requirements.txt      ← 필요한 라이브러리
├── service_account.json.json  ← 구글 API 키
└── output/               ← 생성된 이미지 저장
```

## 🔧 문제 해결

**"python을 찾을 수 없습니다" 오류:**
- Python이 설치되어 있는지 확인
- 환경변수 PATH에 Python이 추가되어 있는지 확인

**"No module named ..." 오류:**
```bash
pip install -r requirements.txt
```

**시트 연결 오류:**
- `service_account.json.json` 파일이 있는지 확인
- 구글 시트가 서비스 계정과 공유되어 있는지 확인

## 📌 팁

- 날짜는 자동으로 시트의 최신 날짜를 찾습니다
- 특정 날짜를 지정하려면: `python main.py --date 2025.12.04`
- 테스트 데이터로 실행: `python main.py --test`


